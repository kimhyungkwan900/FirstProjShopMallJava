import{a as R,j as e,u as y,r as n,R as f,A as v}from"./index-BriUKL8v.js";import{P as D}from"./Pagination-D5Npcb15.js";const _=async t=>(await R.get("/api/admin/claims",{params:t})).data,L=async(t,l)=>(await R.patch("/api/admin/claims/status",t,{withCredentials:!0,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":l}})).data,A=({claimManage:t})=>{const l={CANCEL_REQUEST:"취소 신청",CANCEL_COMPLETE:"취소 완료",CANCEL_REJECTED:"취소 반려",RETURN_REQUEST:"반품 신청",RETURN_COMPLETE:"반품 완료",RETURN_REJECTED:"반품 반려",EXCHANGE_REQUEST:"교환 신청",EXCHANGE_COMPLETE:"교환 완료",EXCHANGE_REJECTED:"교환 반려"};return e.jsxs("ul",{className:"p-10 ",children:[e.jsxs("li",{className:"mb-2",children:[e.jsx("p",{className:"font-bold",children:"요청ID:"})," ",t.orderReturn.id]}),e.jsxs("li",{className:"mb-2",children:[e.jsx("p",{className:"font-bold",children:"고객ID:"}),": ",t.orderReturn.memberId]}),e.jsxs("li",{className:"mb-2",children:[e.jsx("p",{className:"font-bold",children:"주문ID:"})," ",t.orderReturn.orderId]}),e.jsxs("li",{className:"mb-2",children:[e.jsx("p",{className:"font-bold",children:"요청유형:"})," ",l[t.orderReturn.returnType]??t.orderReturn.returnType]}),e.jsxs("li",{className:"mb-2",children:[e.jsx("p",{className:"font-bold",children:"요청내용:"})," ",t.orderReturn.reason]}),e.jsxs("li",{className:"mb-2",children:[e.jsx("p",{className:"font-bold",children:"요청내용 상세:"})," ",t.orderReturn.detail]})]})},S=({searchFilters:t,currentPage:l,onPageChange:o})=>{const d=y(),[c,i]=n.useState([]),[E,u]=n.useState(1),[s,h]=n.useState(null),[T,m]=n.useState(!1),[x,C]=n.useState(null),p=n.useCallback(async()=>{const a={...t,page:l};try{const r=await _(a);i(r.claims.content),u(r.totalPage),h(null)}catch(r){console.error("고객 요청 목록 불러오기 실패:",r),i([]),u(1)}},[t,l]);n.useEffect(()=>{p()},[p]);const j=async a=>{if(s!==null)try{await L({id:s,approval:a},d)}catch(r){console.log("상태변경 실패: ",r)}finally{await p()}},b=a=>{C(a),m(!0)},N=()=>{m(!1),C(null)},g={CANCEL_REQUEST:"취소 신청",CANCEL_COMPLETE:"취소 완료",CANCEL_REJECTED:"취소 반려",RETURN_REQUEST:"반품 신청",RETURN_COMPLETE:"반품 완료",RETURN_REJECTED:"반품 반려",EXCHANGE_REQUEST:"교환 신청",EXCHANGE_COMPLETE:"교환 완료",EXCHANGE_REJECTED:"교환 반려"};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col ml-10 mr-10 mt-10 relative",children:[e.jsx("button",{className:"absolute w-20 top-0 left-0 bg-gray-400 text-white rounded",onClick:()=>j("승인"),disabled:s===null,children:"승인"}),e.jsx("button",{className:"absolute w-20 top-0 left-24 bg-gray-400 text-white rounded",onClick:()=>j("반려"),disabled:s===null,children:"반려"}),e.jsxs("table",{id:"list",className:"border border-gray-400 mt-8",children:[e.jsxs("tr",{className:"bg-gray-400",children:[e.jsx("th",{}),e.jsx("th",{children:"요청ID"}),e.jsx("th",{children:"고객ID"}),e.jsx("th",{children:"주문ID"}),e.jsx("th",{children:"요청유형"}),e.jsx("th",{children:"요청날짜"})]}),c.length===0?e.jsx("tr",{}):c.map(a=>e.jsxs("tr",{className:"text-center hover:bg-gray-100 cursor-pointer",onClick:()=>b(a),children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:s===a.claimId,onClick:r=>r.stopPropagation(),onChange:r=>{r.target.checked?h(a.claimId):h(null)}})}),e.jsx("td",{children:a.claimId}),e.jsx("td",{children:a.orderReturn.memberId}),e.jsx("td",{children:a.orderReturn.orderId}),e.jsx("td",{children:g[a.orderReturn.returnType]??a.orderReturn.returnType}),e.jsx("td",{children:new Date(a.orderReturn.regDate).toLocaleDateString()})]},a.claimId))]}),e.jsx(D,{currentPage:l,totalPages:E,onPageChange:o})]}),e.jsxs(f,{isOpen:T,onRequestClose:N,overlayClassName:"fixed inset-0 bg-black bg-transparent flex justify-center items-center",className:"relative bg-white w-9/20 border rounded-lg overflow-auto mx-auto",style:{content:{top:"1%",left:"1%",right:"1%"}},children:[e.jsx("button",{className:"absolute top-1 right-1 text-5xl text-gray-600 hover:text-gray-900",onClick:N,children:"×"}),x&&e.jsx(A,{claimManage:x})]})]})},U=()=>{const[t,l]=n.useState({searchType:"",searchContent:"",returnType:"",startDate:"",endDate:""}),[o,d]=n.useState(0),[c,i]=n.useState(t),E=()=>{i(t),d(0)},u=s=>{d(s)};return e.jsxs(v,{children:[e.jsxs("div",{className:"space-y-2 ml-10 mt-10",children:[e.jsx("span",{className:"font-bold",children:"검색유형:"}),e.jsxs("select",{value:t.searchType,onChange:s=>l({...t,searchType:s.target.value}),className:"border ml-2 p-1 rounded",children:[e.jsx("option",{value:null,children:"-"}),e.jsx("option",{value:"주문 ID",children:"주문 ID"}),e.jsx("option",{value:"고객 ID",children:"고객 ID"})]}),e.jsx("input",{type:"text",value:t.searchContent,onChange:s=>l({...t,searchContent:s.target.value}),className:"border ml-2 p-1 rounded"}),e.jsx("span",{className:"font-bold ml-5",children:"고객 요청 유형:"}),e.jsxs("select",{value:t.returnType,onChange:s=>l({...t,returnType:s.target.value}),className:"border ml-2 p-1 rounded",children:[e.jsx("option",{value:null,children:"-"}),e.jsx("option",{value:"CANCEL_REQUEST",children:"취소신청"}),e.jsx("option",{value:"CANCEL_COMPLETE",children:"취소완료"}),e.jsx("option",{value:"CANCEL_REJECTED",children:"취소반려"}),e.jsx("option",{value:"RETURN_REQUEST",children:"반품신청"}),e.jsx("option",{value:"RETURN_COMPLETE",children:"반품완료"}),e.jsx("option",{value:"RETURN_REJECTED",children:"반품반려"}),e.jsx("option",{value:"EXCHANGE_REQUEST",children:"교환신청"}),e.jsx("option",{value:"EXCHANGE_COMPLETE",children:"교환완료"}),e.jsx("option",{value:"EXCHANGE_REJECTED",children:"교환반려"})]}),e.jsx("span",{className:"font-bold ml-5",children:"요청일자:"}),e.jsx("input",{type:"date",value:t.startDate,onChange:s=>l({...t,startDate:s.target.value}),className:"border ml-2 p-1 rounded"}),e.jsx("input",{type:"date",value:t.endDate,onChange:s=>l({...t,endDate:s.target.value}),className:"border ml-2 p-1 rounded"})]}),e.jsx("button",{className:"bg-blue-500 text-white px-4 py-1 ml-10 rounded",onClick:E,children:"검색"}),e.jsx(S,{searchFilters:c,currentPage:o,onPageChange:u})]})};export{U as default};
