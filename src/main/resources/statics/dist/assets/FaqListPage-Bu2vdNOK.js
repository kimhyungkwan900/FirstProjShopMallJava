import{j as e,L as N,u as f,b as v,r as m,A as k}from"./index-DL8XAv-9.js";import{g as S,d as C}from"./FaqApi-C2NEp9rC.js";const w=({faq:s,index:d,isChecked:x,onCheck:o})=>{const h=r=>r?new Date(r).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}):"-";return e.jsxs("tr",{className:"border",children:[e.jsx("td",{className:"px-2 text-center",children:e.jsx("input",{type:"checkbox",checked:x,onChange:()=>o(s.id)})}),e.jsx("td",{className:"border px-2 text-center",children:d}),e.jsx("td",{className:"border px-2 text-center",children:s.category}),e.jsx("td",{className:"border px-2 text-blue-600 hover:underline",children:e.jsx(N,{to:`/admin/faq/detail/${s.id}`,children:s.question})}),e.jsx("td",{className:"border px-2 text-center",children:h(s.createdAt)})]})},L=({searchParams:s,setSearchParams:d,onSearch:x})=>{const o=r=>{const{name:i,value:t}=r.target;d({...s,[i]:t})},h=r=>{var l,u;r.preventDefault();const i=(l=s.category)==null?void 0:l.trim(),t=(u=s.keyWord)==null?void 0:u.trim();if(!i){alert("카테고리를 선택하세요");return}x({category:i,keyWord:t})};return e.jsxs("form",{onSubmit:h,className:"flex items-center space-x-4 mb-4",children:[e.jsxs("select",{name:"category",value:s.category,onChange:o,className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"",children:"카테고리 선택"}),e.jsx("option",{value:"배송",children:"배송"}),e.jsx("option",{value:"취소/교환/반품",children:"취소/교환/반품"}),e.jsx("option",{value:"환불",children:"환불"}),e.jsx("option",{value:"주문/결제",children:"주문/결제"}),e.jsx("option",{value:"기타",children:"기타"})]}),e.jsx("input",{type:"text",name:"keyWord",value:s.keyWord,onChange:o,placeholder:"검색어 입력",className:"border px-2 py-1 rounded w-60"}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-1 rounded hover:bg-blue-600",children:"검색"})]})},F=({currentPage:s,totalCount:d,pageSize:x,onPageChange:o})=>{const h=Math.ceil(d/x),r=10,t=Math.floor((s-1)/r)*r+1,l=Math.min(t+r-1,h),u=[];for(let c=t;c<=l;c++)u.push(c);return e.jsxs("div",{className:"flex justify-center mt-4 space-x-2",children:[t>1&&e.jsx("button",{onClick:()=>o(t-1),className:"px-2 py-1 border rounded hover:bg-gray-100",children:"이전"}),u.map(c=>e.jsx("button",{onClick:()=>o(c),className:`px-3 py-1 border rounded ${s===c?"bg-blue-500 text-white":"hover:bg-gray-100"}`,children:c},c)),l<h&&e.jsx("button",{onClick:()=>o(l+1),className:"px-2 py-1 border rounded hover:bg-gray-100",children:"다음"})]})},A=()=>{const s=f();v();const[d,x]=m.useState([]),[o,h]=m.useState(0),[r,i]=m.useState([]),[t,l]=m.useState({category:"",keyWord:"",page:1,size:10}),[u,c]=m.useState(!1),g=n=>{i(a=>a.includes(n)?a.filter(p=>p!==n):[...a,n])},b=async(n=t)=>{console.log("📦 요청 searchParams:",n);try{const a=await S(n);console.log("📦 받아온 응답:",a),x(a.dtoList||[]),h(a.totalCount||0)}catch(a){console.error("FAQ 목록을 불러오는데 실패했습니다.",a)}},j=({category:n,keyWord:a})=>{c(!0);const p={category:n,keyWord:a,page:1,size:10};l(p),b(p)};m.useEffect(()=>{b(),c(!1)},[t.page,t.size]);const y=async()=>{if(r.length===0){alert("삭제할 항목을 선택하세요.");return}if(window.confirm("정말로 삭제하시겠습니까?"))try{await C(r),alert("삭제가 완료 되었습니다"),i([]),b()}catch(a){console.log("삭제 실패",a),alert("삭제 중 오류가 발생했습니다")}};return e.jsx(k,{children:e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"FAQ 목록"}),e.jsx(L,{searchParams:t,setSearchParams:l,onSearch:j}),e.jsxs("table",{className:"w-full border",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray=100 text-left",children:[e.jsx("th",{className:"border px-2",children:"선택"}),e.jsx("th",{className:"border px-2",children:"번호"}),e.jsx("th",{className:"border px-2",children:"분류"}),e.jsx("th",{className:"border px-2",children:"제목"}),e.jsx("th",{className:"border px-2",children:"작성일"})]})}),e.jsx("tbody",{children:d.length>0?d.map((n,a)=>e.jsx(w,{faq:n,index:a+1+(t.page-1)*t.size,isChecked:r.includes(n.id),onCheck:g},n.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-4",children:"FAQ가 없습니다."})})})]}),e.jsxs("div",{className:"my-4 flex justify-between items-center",children:[e.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",onClick:y,disabled:r.length===0,children:"삭제"}),e.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:()=>s("/admin/faq/register"),children:"등록하기"})]}),e.jsx(F,{currentPage:t.page,totalCount:o,pageSize:t.size,onPageChange:n=>l({...t,page:n})})]})})};export{A as default};
